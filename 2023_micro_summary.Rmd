---
title: "Overall Microstructure Summary for Portion Size Meals"
output:
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
header-includes:
- \usepackage{fullpage}
- \usepackage{graphicx}
- \usepackage{subcaption}
- \usepackage{float}
- \usepackage{placeins}
- \usepackage{caption}
- \usepackage{mathtools}
# - \usepackage{multirow}
- \usepackage{amssymb}
- \usepackage{amsmath}
- \usepackage{bigstrut}
- \usepackage{geometry}
# - \usepackage{pdflscape}
- \setlength{\parskip}{1em}
geometry: margin=1.3cm
---

<!-- Copywrite -->

```{r include=FALSE, echo = FALSE}
# This script report was written by Alaina Pearce in February 2023 to 
# examine consistency of meal microstructure across portion sizes (
# data from Food and Brain Study).
#
#     Copyright (C) 2023 Alaina L Pearce
#
#     This program is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This program is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <https://www.gnu.org/licenses/>.

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy = TRUE, tidy.opts = list(comment = FALSE), echo = TRUE, fig.width=6, fig.height=4, fig.path='figs/', echo=FALSE, warning=FALSE, message=FALSE, comment = NA)
```

<!-- load startup file and any extra packages -->

```{r load, echo=FALSE, include=FALSE}
library(knitr)
library(kableExtra)
library(stats)
library(haven)
library(reshape2)
library(irr)
library(vegan)
library(pairwiseAdonis)
library(lme4)
library(lmerTest)
library(rmcorr)
library(ggplot2)
library(ggpubr)

library(gtsummary)
theme_gtsummary_compact()
# 
# library(car)
# library(emmeans)
# library(lavaan)
```

```{r load_scripts, echo=FALSE, results='asis'}
source('functions.R')
source('setup.R')
source('analyses.R')
source('figures.R')
source('tables.R')
```

\clearpage

# Demographics

\FloatBarrier

```{r demo_tab, echo=FALSE, results='asis'}
as_kable_extra(demo_tab, caption = 'Demographics', format = "latex", booktabs = TRUE, longtable = FALSE) %>%
  kableExtra::kable_styling(latex_options = "hold_position",  full_width = FALSE)
```

\FloatBarrier


# Meal Intake

\FloatBarrier


```{r meal_tab, echo=FALSE, results='asis'}
as_kable_extra(intake_tab, caption = 'Meal Intake', format = "latex", booktabs = TRUE, longtable = FALSE) %>%
  kableExtra::kable_styling(latex_options = "hold_position",  full_width = FALSE)
```

\FloatBarrier

# Microstructure

## Behaviors Across Meals

\FloatBarrier
```{r miro_beh_tab, echo=FALSE, results='asis'}
as_kable_extra(micro_beh_tab, caption = 'Microstructure Behaviors by Portion Size Meal', format = "latex", booktabs = TRUE, longtable = FALSE) %>%
  kableExtra::kable_styling(latex_options = "hold_position",  full_width = FALSE)
```

## Coding Reliability

\FloatBarrier

```{r coding_icc_tab, echo=FALSE, results='asis'}
kable(icc_table, "latex",  digits = 3, caption = "Coding Reliability - ICC", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

## Portion Correlation Matrices

\FloatBarrier

```{r cormat_ps1, echo=FALSE, results='asis'}
kable(ps1_cormat, "latex",  digits = 3, caption = "Portion Size 1: Correlation Matrix", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r cormat_ps2, echo=FALSE, results='asis'}
kable(ps2_cormat, "latex",  digits = 3, caption = "Portion Size 2: Correlation Matrix", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r cormat_ps3, echo=FALSE, results='asis'}
kable(ps3_cormat, "latex",  digits = 3, caption = "Portion Size 3: Correlation Matrix", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r cormat_ps4, echo=FALSE, results='asis'}
kable(ps1_cormat, "latex",  digits = 3, caption = "Portion Size 4: Correlation Matrix", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r cormat_fig_ps1, echo=FALSE, include = TRUE}
ps1_mat_plot
```

\FloatBarrier

```{r cormat_fig_ps2, echo=FALSE, include = TRUE}
ps2_mat_plot
```

\FloatBarrier

```{r cormat_fig_ps3, echo=FALSE, include = TRUE}
ps3_mat_plot
```

\FloatBarrier

```{r cormat_fig_ps4, echo=FALSE, include = TRUE}
ps4_mat_plot
```

\FloatBarrier

# Test of Multivariate Dispersons

\FloatBarrier

```{r beh_disp, echo=FALSE}
permutest(all_beh_disp, pairwise = TRUE, permutations = 999)
```

\FloatBarrier

```{r beh_disp_plot, echo=FALSE, include = TRUE}
plot(all_beh_disp, ellipse = TRUE, hull = FALSE, conf = 0.95)
```

\FloatBarrier

# Permutational Multivariate Analysis of Variance Using Distance Matrices

\FloatBarrier

## Portion Size
```{r adonis_ps, echo=FALSE}
all_beh_psmod
```

\FloatBarrier

```{r adonis_ps_pairwise, echo=FALSE}
all_beh_ps_pairs
```

\FloatBarrier

## Visits

```{r adonis_visits, echo=FALSE}
all_beh_vmod
```

\FloatBarrier

## Exploratory Univariate Analyses

\FloatBarrier

```{r nbites_ps_mod, echo=FALSE, results='asis'}
nbites_sum <- summary(nbites_mod)
kable(round(nbites_sum$coefficients, 3), caption = 'Number of Bites by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r nsips_ps_mod, echo=FALSE, results='asis'}
nsips_sum <- summary(nsips_mod)
kable(round(nsips_sum$coefficients, 3), caption = 'Number of Sips by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r active_eat_ps_mod, echo=FALSE, results='asis'}
active_eat_sum <- summary(active_eat_mod)
kable(round(active_eat_sum$coefficients, 3), caption = 'Active Eating Time (min) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r meal_dur_ps_mod, echo=FALSE, results='asis'}
meal_dur_sum <- summary(meal_dur_mod)
kable(round(meal_dur_sum$coefficients, 3), caption = 'Meal Duration (min) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r bite_latency_ps_mod, echo=FALSE, results='asis'}
bite_latency_sum <- summary(bite_latency_mod)
kable(round(bite_latency_sum$coefficients, 3), caption = 'Latency to First Bite (min) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r bite_rate_ps_mod, echo=FALSE, results='asis'}
bite_rate_sum <- summary(bite_rate_mod)
kable(round(bite_rate_sum$coefficients, 3), caption = 'Bites/min by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r bite_rate_active_ps_mod, echo=FALSE, results='asis'}
bite_rate_active_sum <- summary(bite_rate_active_mod)
kable(round(bite_rate_active_sum$coefficients, 3), caption = 'Bites/min (active) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r sip_rate_ps_mod, echo=FALSE, results='asis'}
sip_rate_sum <- summary(sip_rate_mod)
kable(round(sip_rate_sum$coefficients, 3), caption = 'Sips/min by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r sip_rate_active_ps_mod, echo=FALSE, results='asis'}
sip_rate_active_sum <- summary(sip_rate_active_mod)
kable(round(sip_rate_active_sum$coefficients, 3), caption = 'Sips/min (active) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r bite_g_ps_mod, echo=FALSE, results='asis'}
bite_size_g_sum <- summary(bite_size_g_mod)
kable(round(bite_size_g_sum$coefficients, 3), caption = 'g/Bite by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r bite_kcal_ps_mod, echo=FALSE, results='asis'}
bite_size_kcal_sum <- summary(bite_size_kcal_mod)
kable(round(bite_size_kcal_sum$coefficients, 3), caption = 'kcal/Bite by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r g_rate_ps_mod, echo=FALSE, results='asis'}
eat_rate_g_sum <- summary(eat_rate_g_mod)
kable(round(eat_rate_g_sum$coefficients, 3), caption = 'g/min by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r kcal_rate_ps_mod, echo=FALSE, results='asis'}
eat_rate_kcal_sum <- summary(eat_rate_kcal_mod)
kable(round(eat_rate_kcal_sum$coefficients, 3), caption = 'kcal/min by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r g_rate_active_ps_mod, echo=FALSE, results='asis'}
eat_rate_active_g_sum <- summary(eat_rate_active_g_mod)
kable(round(eat_rate_active_g_sum$coefficients, 3), caption = 'g/min (active) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r kcal_rate_active_ps_mod, echo=FALSE, results='asis'}
eat_rate_active_kcal_sum <- summary(eat_rate_active_kcal_mod)
kable(round(eat_rate_active_kcal_sum$coefficients, 3), caption = 'kcal/min (active) by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r prop_active_ps_mod, echo=FALSE, results='asis'}
prop_active_sum <- summary(prop_active_mod)
kable(round(prop_active_sum$coefficients, 3), caption = 'active eating/meal duration, min by Portion Size Meal', format = "latex", longtable = FALSE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

## Repeated Measures Correlation

```{r cormat_rmcorr, echo=FALSE, results='asis'}
kable(boot_mat, "latex",  digits = 3, caption = "Repeated Measures: Correlation Matrix", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r cormat_fig_rmcorr, echo=FALSE, include = FALSE}
rmcorr_mat_plot
```


### ICC across portion sizes

\FloatBarrier

```{r micr_icc_tab, echo=FALSE, results='asis'}
kable(as.matrix(ps_icc_tab), "latex",  digits = 3, caption = "Coding Reliability - ICC", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```


# Replication of 'Obesogenic' Style of Eating

## Association with Intake

\FloatBarrier

```{r obpattern_intake, echo=FALSE, results='asis'}
kable(rep_ob_intake_table, "latex",  digits = 3, caption = "Standardized Coefficitens for Association Between Eating Behaivors and Intake (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

### Portion Size 1

```{r ps1_obpattern_g_intake, echo=FALSE, results='asis'}
kable(summary(ps1_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 1 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (g) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps1_obpattern_kcal_intake, echo=FALSE, results='asis'}
kable(summary(ps1_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 1 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (kcal) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Portion Size 3

```{r ps2_obpattern_g_intake, echo=FALSE, results='asis'}
kable(summary(ps2_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 3 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (g) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps2_obpattern_kcal_intake, echo=FALSE, results='asis'}
kable(summary(ps2_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 2 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (kcal) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Portion Size 3

```{r ps3_obpattern_g_intake, echo=FALSE, results='asis'}
kable(summary(ps3_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 3 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (g) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps3_obpattern_kcal_intake, echo=FALSE, results='asis'}
kable(summary(ps3_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 3 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (kcal) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Portion Size 4

```{r ps4_obpattern_g_intake, echo=FALSE, results='asis'}
kable(summary(ps4_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 4 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (g) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps4_obpattern_kcal_intake, echo=FALSE, results='asis'}
kable(summary(ps4_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 4 - Standardized Coefficitens for Association Between Eating Behaivors and Intake (kcal) (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

## Associaiton with BMI Percentile

\FloatBarrier

```{r obpattern_intake_tab, echo=FALSE, results='asis'}
kable(rep_ob_bmi_table, "latex",  digits = 3, caption = "Standardized Coefficitens for Association Between Eating Behaivors and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

### Portion Size 1

```{r ps1_obpattern_g_bmi, echo=FALSE, results='asis'}
kable(summary(ps1_bmi_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 1 - Standardized Coefficitens for Association Between Eating Behaivors (g) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps1_obpattern_kcal_bmi, echo=FALSE, results='asis'}
kable(summary(ps1_bmi_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 1 - Standardized Coefficitens for Association Between Eating Behaivors (kcal) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Portion Size 2

```{r ps2_obpattern_g_bmi, echo=FALSE, results='asis'}
kable(summary(ps2_bmi_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 3 - Standardized Coefficitens for Association Between Eating Behaivors (g) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps2_obpattern_kcal_bmi, echo=FALSE, results='asis'}
kable(summary(ps2_bmi_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 2 - Standardized Coefficitens for Association Between Eating Behaivors (kcal) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Portion Size 3

```{r ps3_obpattern_g_bmi, echo=FALSE, results='asis'}
kable(summary(ps3_bmi_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 3 - Standardized Coefficitens for Association Between Eating Behaivors (g) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

```{r ps3_obpattern_kcal_bmi, echo=FALSE, results='asis'}
kable(summary(ps3_bmi_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 3 - Standardized Coefficitens for Association Between Eating Behaivors (kcal) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier

### Portion Size 4

```{r ps4_obpattern_g_bmi, echo=FALSE, results='asis'}
kable(summary(ps4_bmi_g_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 4 - Standardized Coefficitens for Association Between Eating Behaivors (g) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier


```{r ps4_obpattern_kcal_bmi, echo=FALSE, results='asis'}
kable(summary(ps4_bmi_kcal_cov_stdmod)$coefficients, "latex",  digits = 3, caption = "Portion Size 4 - Standardized Coefficitens for Association Between Eating Behaivors (kcaal) and BMI Percentile (adjusted for age, sex, liking, and fullness)", booktabs=TRUE) %>%
  kable_styling(latex_options = c("hold_position", "repeat_header"))
```

\FloatBarrier
